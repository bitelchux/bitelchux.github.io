<html>

<head>

<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />  

<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />

<script src="//code.jquery.com/jquery.min.js" type="text/javascript"></script>     

<link href='//fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

<style>
html{
	background-color:white;
	
}
body{

 margin:15px;

 padding:15px;

 text-align:center;
background-color:white;
 vertical-align:middle;

}

* {

font-family:'Roboto',Verdana;

color:silver;

font-size:big;

}

#teaser{

    background-color:black;
font-size:2.5em;
	color:white;

	position:absolute;

	bottom:0px;

	left:0px;

	width:100%;
	
	padding:10px;
	paddind-left:25px;
	padding-right:25px;
}	

</style>

<script>

/*! Backstretch - v2.0.4 - 2013-06-19

* http://srobbin.com/jquery-plugins/backstretch/

* Copyright (c) 2013 Scott Robbin; Licensed MIT */

(function(a,d,p){a.fn.backstretch=function(c,b){(c===p||0===c.length)&&a.error("No images were supplied for Backstretch");0===a(d).scrollTop()&&d.scrollTo(0,0);return this.each(function(){var d=a(this),g=d.data("backstretch");if(g){if("string"==typeof c&&"function"==typeof g[c]){g[c](b);return}b=a.extend(g.options,b);g.destroy(!0)}g=new q(this,c,b);d.data("backstretch",g)})};a.backstretch=function(c,b){return a("body").backstretch(c,b).data("backstretch")};a.expr[":"].backstretch=function(c){return a(c).data("backstretch")!==p};a.fn.backstretch.defaults={centeredX:!0,centeredY:!0,duration:5E3,fade:0};var r={left:0,top:0,overflow:"hidden",margin:0,padding:0,height:"100%",width:"100%",zIndex:-999999},s={position:"absolute",display:"none",margin:0,padding:0,border:"none",width:"auto",height:"auto",maxHeight:"none",maxWidth:"none",zIndex:-999999},q=function(c,b,e){this.options=a.extend({},a.fn.backstretch.defaults,e||{});this.images=a.isArray(b)?b:[b];a.each(this.images,function(){a("<img />")[0].src=this});this.isBody=c===document.body;this.$container=a(c);this.$root=this.isBody?l?a(d):a(document):this.$container;c=this.$container.children(".backstretch").first();this.$wrap=c.length?c:a('<div class="backstretch"></div>').css(r).appendTo(this.$container);this.isBody||(c=this.$container.css("position"),b=this.$container.css("zIndex"),this.$container.css({position:"static"===c?"relative":c,zIndex:"auto"===b?0:b,background:"none"}),this.$wrap.css({zIndex:-999998}));this.$wrap.css({position:this.isBody&&l?"fixed":"absolute"});this.index=0;this.show(this.index);a(d).on("resize.backstretch",a.proxy(this.resize,this)).on("orientationchange.backstretch",a.proxy(function(){this.isBody&&0===d.pageYOffset&&(d.scrollTo(0,1),this.resize())},this))};q.prototype={resize:function(){try{var a={left:0,top:0},b=this.isBody?this.$root.width():this.$root.innerWidth(),e=b,g=this.isBody?d.innerHeight?d.innerHeight:this.$root.height():this.$root.innerHeight(),j=e/this.$img.data("ratio"),f;j>=g?(f=(j-g)/2,this.options.centeredY&&(a.top="-"+f+"px")):(j=g,e=j*this.$img.data("ratio"),f=(e-b)/2,this.options.centeredX&&(a.left="-"+f+"px"));this.$wrap.css({width:b,height:g}).find("img:not(.deleteable)").css({width:e,height:j}).css(a)}catch(h){}return this},show:function(c){if(!(Math.abs(c)>this.images.length-1)){var b=this,e=b.$wrap.find("img").addClass("deleteable"),d={relatedTarget:b.$container[0]};b.$container.trigger(a.Event("backstretch.before",d),[b,c]);this.index=c;clearInterval(b.interval);b.$img=a("<img />").css(s).bind("load",function(f){var h=this.width||a(f.target).width();f=this.height||a(f.target).height();a(this).data("ratio",h/f);a(this).fadeIn(b.options.speed||b.options.fade,function(){e.remove();b.paused||b.cycle();a(["after","show"]).each(function(){b.$container.trigger(a.Event("backstretch."+this,d),[b,c])})});b.resize()}).appendTo(b.$wrap);b.$img.attr("src",b.images[c]);return b}},next:function(){return this.show(this.index<this.images.length-1?this.index+1:0)},prev:function(){return this.show(0===this.index?this.images.length-1:this.index-1)},pause:function(){this.paused=!0;return this},resume:function(){this.paused=!1;this.next();return this},cycle:function(){1<this.images.length&&(clearInterval(this.interval),this.interval=setInterval(a.proxy(function(){this.paused||this.next()},this),this.options.duration));return this},destroy:function(c){a(d).off("resize.backstretch orientationchange.backstretch");clearInterval(this.interval);c||this.$wrap.remove();this.$container.removeData("backstretch")}};var l,f=navigator.userAgent,m=navigator.platform,e=f.match(/AppleWebKit\/([0-9]+)/),e=!!e&&e[1],h=f.match(/Fennec\/([0-9]+)/),h=!!h&&h[1],n=f.match(/Opera Mobi\/([0-9]+)/),t=!!n&&n[1],k=f.match(/MSIE ([0-9]+)/),k=!!k&&k[1];l=!((-1<m.indexOf("iPhone")||-1<m.indexOf("iPad")||-1<m.indexOf("iPod"))&&e&&534>e||d.operamini&&"[object OperaMini]"==={}.toString.call(d.operamini)||n&&7458>t||-1<f.indexOf("Android")&&e&&533>e||h&&6>h||"palmGetResource"in d&&e&&534>e||-1<f.indexOf("MeeGo")&&-1<f.indexOf("NokiaBrowser/8.5.0")||k&&6>=k)})(jQuery,window);

function getP(name) {

    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");

    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),

        results = regex.exec(location.search);

    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));

}

$(document).ready(function(){




    



})


</script>



<body>
<script src="http://www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js"></script>
<h1>asdasd</h1>
<iframe title="YouTube video player" width="100%" height="700" src="//www.youtube.com/embed/ckb5UEWPCAI?autoplay=1" frameborder="0" allowfullscreen></iframe>
<div id="dbug" style="display:none;position:absolute;top:100px;left:0px;background-color:blue">asdadasdasd</div>
<div id="debugDiv" style="display:none;position:absolute;top:250px;left:0px;background-color:green">Console</div>

<img id="imagen" src="t1024.png"/>

<div id="teaser" >
Tweet news Caster, tweet from your phone (tap on a picture, activate AutoPilot, tap next or previous buttons or perform a new query)


</div>
<script>
if (typeof console  != "undefined") 
    if (typeof console.log != 'undefined')
        console.olog = console.log;
    else
        console.olog = function() {};

console.log = function(message) {
    console.olog(message);
    $('#debugDiv').append('<p>' + message + '</p>');
};
console.error = console.debug = console.info =  console.log

	//setInterval(function(){ document.location.href="https://bitelchux.github.io/twit/?r="+Math.random() }, 30000);
	$("#dbug").html(Math.random());
	var packageID="botijo.twitter.chromecast";
	var posx=0;
	var posy=0;
	var theSenderID=0;
	var customMessageBus=null;
	
	function startChromeCastMode() {
		window.onload = function() {
		
			window.castReceiverManager = cast.receiver.CastReceiverManager.getInstance();
			window.castReceiverManager.onSenderDisconnected = function(event) {
			  $('#dbug').html('<br/>disconnect'+ event.data);
			  if(window.castReceiverManager.getSenders().length == 0) {
				  window.close();
			  }
			}
			customMessageBus = window.castReceiverManager.getCastMessageBus('urn:x-cast:'+packageID);
			
		
			customMessageBus.onMessage = function(event) {
				 
				 theSenderID = event.senderId;
				$('#dbug').html('<br/>connected'+ theSenderID+'recived:'+event.data);
				var json = $.parseJSON(event.data);
			$('#dbug').html($('#dbug').html()+"<br/>"+json.action+"<br/>"+json.p1+"<br/>"+json.p2);
				if (json.action=="VIEW"){
					
					var img=document.getElementById("imagen") 
					$("#imagen").fadeOut("slow", function() {

						img.src=json.p1;
						img.onload = function () {
						        $("#imagen").fadeIn();       
						 };
						
					    // Animation complete.
  					});
					var txt=decodeURIComponent(json.p2);
					txt = txt.replace(/^(\[url=)?(https?:\/\/)?(www\.|\S+?\.)(\S+?\.)?\S+$\s*/mg, '');
					$("#teaser").html(txt);
					    if ($(window).width()>$(window).height()){
							img.height=$(window).height()-180       
						}else{
							img.width=$(window).width()-40   
						}	
				}
				/*
				if (event.data.indexOf("RESET")>=0){
					//$('#dbug').html('<br/>dataokxreset:'+event.data);
					ChangeLevel(0);
					return 0;
				}
				if (event.data.indexOf("MENU")>=0){
					//$('#dbug').html('<br/>dataokxMENU:'+event.data);
					document.location.href=document.location.href
					return 0;
					
				}
				if (event.data.indexOf("QUIT")>=0){
					//$('#dbug').html('<br/>dataokxQUIT:'+event.data);
					window.close();
					return 0;
				}
				//$('#dbug').html('<br/>dataokx:'+event.data);
				//var aux=event.data.replace("move","0");
				//var aux=aux.replace("click","1");
			//	$('#dbug').html('<br/>dataok:'+aux);
				
				/*
				if (json.action=="clickon"){
					clickOn(json.x,json.y);
				}
				
				if (json.action=="clickoff"){
					clicka(json.x,json.y);											
				}
				*/
			}
			window.castReceiverManager.start();
			//$('#dbug').html('<br/>y');
		}
	};


	startChromeCastMode();
	/*
	if (typeof console  != "undefined") 
		if (typeof console.log != 'undefined')
			console.olog = console.log;
		else
			console.olog = function() {};
	console.log = function(message) {
		console.olog(message);
		$('#dbug').html('<br/>console:' + message);
	};
	console.error = console.debug = console.info =  console.log
	*/
	//OJO
	//setInterval(function(){location.reload() }, 45000);
	function clicka(x,y){
		//$('#dbug').html('<br/>clicka:'+navigator.userAgent);
		if (MODE=="MENU"){
			setMode('GAME');
			if ($("#btnstart").hasClass("selected")){
			
				Init(0);
				
			}
			if ($("#btncontinue").hasClass("selected"))
				Continue();					
		}else{
			//RESET
			ChangeLevel(0)
		}
	}
	var timerClickOn=null;
	function clickOn(x,y){
		//$('#dbug').html('<br/>clickon');
		Move(x,y)

	}
	function clickOff(x,y){
		//$('#dbug').html('<br/>clickoff');

	}
	function send(id,msg){
		//$('#dbug').html('<br/>message sent to sender init');
		customMessageBus.send(id,msg);
		//$('#dbug').html('<br/>message sent to sender ok');
	}
	document.onkeydown = checkKey;
	function checkKey(e) {
		e = e || window.event;
		if (e.keyCode == '38') {
			posy=posy-10
			drawCursor(posx,posy)
		}
		else if (e.keyCode == '40') {
			posy=posy+10
			drawCursor(posx,posy)
		}
		else if (e.keyCode == '37') {
			posx=posx-10
			drawCursor(posx,posy)
		}
		else if (e.keyCode == '39') {
			posx=posx+10
			drawCursor(posx,posy)
		}
		else if (e.keyCode == '13') {
			clicka(posx,posy)
		}
	}



</script>

</body>
</html>
